# 狼人杀游戏回放可视化系统

基于 Flask 的狼人杀游戏日志可视化和回放系统。

## 功能特性

- 📂 **日志选择**: 从`.training/game_logs/`目录中选择游戏日志文件
- 🎬 **逐步回放**: 一步一步展示游戏进程
- 🎮 **播放控制**: 播放、暂停、前进、后退、重置
- ⚡ **速度调节**: 可调整播放速度（慢速/中速/快速）
- 👥 **玩家状态**: 实时显示所有玩家的存活状态和角色信息
- 📊 **事件详情**: 详细展示每个游戏事件（夜晚行动、讨论、投票等）
- 🎨 **精美 UI**: 渐变色背景、动画效果、响应式设计

## 安装依赖

```bash
cd visualization
pip install -r requirements.txt
```

## 运行应用

```bash
python app.py
```

应用将在 http://localhost:5000 启动

## 使用方法

1. **启动应用**: 运行 `python app.py`
2. **选择日志**: 在首页选择要查看的游戏日志文件
3. **开始回放**:
   - 点击"播放"按钮自动播放
   - 使用"下一步"/"上一步"手动控制
   - 调整播放速度
   - 随时暂停或重置

## 项目结构

```
visualization/
├── app.py                  # Flask应用主文件
├── parser.py              # 游戏日志解析器
├── state_manager.py       # 游戏状态管理器
├── requirements.txt       # Python依赖
├── templates/
│   └── index.html        # HTML模板
└── static/
    ├── style.css         # 样式文件
    └── script.js         # JavaScript逻辑
```

## API 端点

- `GET /` - 主页面
- `GET /api/logs` - 获取可用的日志文件列表
- `GET /api/load/<filename>` - 加载指定的日志文件
- `GET /api/state` - 获取当前游戏状态
- `GET /api/next` - 前进到下一个事件
- `GET /api/prev` - 回退到上一个事件
- `GET /api/jump/<event_index>` - 跳转到指定事件
- `GET /api/reset` - 重置到开始状态

## 支持的事件类型

- **夜晚阶段**:
  - 守卫保护
  - 狼人选择目标
  - 预言家查验
  - 女巫救人/用毒
- **白天阶段**:
  - 死亡公告
  - 遗言
  - 玩家讨论
- **投票阶段**:
  - 投票
  - 投票汇总
  - 淘汰

## 技术栈

- **后端**: Flask 3.1.0
- **前端**: 原生 JavaScript + HTML5 + CSS3
- **解析**: Python 正则表达式
- **状态管理**: 自定义状态机

## 特色功能

### 1. 智能解析

自动解析游戏日志中的所有事件，包括：

- 夜晚行动（狼人、守卫、预言家、女巫）
- 白天讨论发言
- 投票和淘汰
- 角色信息和死亡原因

### 2. 动画效果

- 平滑的页面过渡
- 卡片悬停效果
- 渐入渐出动画
- 进度条动画

### 3. 响应式设计

- 自适应不同屏幕尺寸
- 移动端友好
- 流式布局

## 未来扩展

可能的增强功能：

- 🎭 角色视角模式
- 📊 统计分析面板
- 🔍 事件搜索和过滤
- 💾 导出为视频/GIF
- 🎨 主题切换
- 📱 移动端优化
- 🌐 多语言支持

## 故障排除

### 找不到日志文件

确保 `.training/game_logs/` 目录存在且包含 `.txt` 格式的游戏日志文件。

### 端口被占用

修改 `app.py` 中的端口号：

```python
app.run(debug=True, host='0.0.0.0', port=5001)  # 改为其他端口
```

### 解析错误

检查游戏日志格式是否与解析器期望的格式一致。

## 许可证

与主项目相同
